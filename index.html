<!DOCTYPE html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>baidu map</title>

<script type="text/javascript" src="http://api.map.baidu.com/api?v=1.2"></script>
<script type="text/javascript" src="./js/RichMarker_min.js"></script>
<style>
body{margin:0;padding:0}
</style>
</head>
<body>
<div style="width:700px;height:400px;border:1px solid gray;margin:10px 0 0 10px;" id="container">
</div>
</body>
</html>
<script type="text/javascript">
//baidu map obj
var map = new BMap.Map("container");

//get the current city and set the map center
var myCity = new BMap.LocalCity();
myCity.get(myLoca);
function myLoca(result){
console.log('myloca');
    var cityName = result.name;
    console.log(cityName)
	if(cityName){
		map.setCenter(cityName);
	}
}
	
	var point = new BMap.Point("上海市"); // 创建点坐标；这个点是由经度和纬度构成的，点可以随意选取 
	map.centerAndZoom(point, 12);  //here is the center of map location

	map.addControl(new BMap.NavigationControl());        // 添加平移缩放控件
    map.addControl(new BMap.OverviewMapControl());       //添加缩略地图控件
    map.enableScrollWheelZoom(); 

	
addTag(116.30816,40.056863,200);
addTag(116.402922,39.99908,149);

function addTag(x,y,num){
	//x -- first location
	//y -- second location
	//num -- money on map
                        //启用滚轮放大缩小
	
	var divtag = '<div name="maptag" style="position: absolute; margin: 0pt; padding: 0pt; width: 80px; height: 26px; left: -10px; top: -35px; overflow: hidden;">'
                +     '<img id="rm3_image" style="border:none;left:0px; top:0px; position:absolute;" src="images/back1.png">'
				+ 	  '<label class=" BMapLabel" unselectable="on" style="position: absolute; -moz-user-select: none; display: inline; cursor: inherit; border: 0px none; padding: 2px 1px 1px; white-space: nowrap; font: 12px arial,simsun; z-index: 80; color: rgb(255, 102, 0); left: 28px; top: 1px;">￥' + num + '</label>'
				+ '</div>';    //tag object
	var maptag = new BMapLib.RichMarker(divtag,  new BMap.Point(x, y),{
                                                  "anchor" : new BMap.Size(-47, -116), //anchor
												  "enableDragging" : false});
	//add the tag to map
	map.addOverlay(maptag);
}

var divimg = document.getElementsByName('maptag');
//add to all div
for(var i = 0; i < divimg.length; i++){
	addEvents(divimg[i]);
}

//add over and leave event
function addEvents(sender){
	var target = sender.getElementsByTagName("img")[0];
	//target is first img element
	sender.addEventListener("mouseover", function(e) {
		target.src = "images/back2.png";
	},false);
	sender.addEventListener("mouseout",function(e){
		target.src = "images/back1.png";
	},false);
}


</script>
